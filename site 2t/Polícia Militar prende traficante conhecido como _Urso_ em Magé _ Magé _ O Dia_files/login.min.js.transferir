var apiUrl="https://api.odia.com.br/v1/",modal=document.getElementById("login-modal"),SPMaskBehavior,spOptions,cartaoBehavior,cartaoOptions;function reset_form(){$("form").each((function(){this.reset()}));var errors=document.querySelectorAll(".box-input.error");[].forEach.call(errors,(function(el){el.classList.remove("error")}));var textErrors=document.querySelectorAll(".error-message");[].forEach.call(textErrors,(function(el){el.innerHTML=""}))}function closeLoginModal(){reset_form(),$("#login-msg, .sucesso-container, .forgot-password-container, .plano-container, .register-container, .login-container").hide(),$("#login-modal").css("display","none"),$("body").css({height:"","overflow-y":""}),$("#register-horoscopo").val(""),$("#register-team").val("")}function showErrorForm(element,message){element.find(".error-message").html(message),element.find(".error-message").parent().find("input, select").focus(),element.addClass("error"),element.find(".error-message").show()}function hideErrorForm(element){1==element.find(".error-message").is(":visible")&&(element.find(".error-message").html(" "),element.find(".error-message").hide(),element.removeClass("error"))}function checkEmail(){$("#login-msg").hide();var email=$("#login-email").val();email&&($("#btn-continue").prop("disabled",!0),$("#btn-continue").val("Carregando..."),$(".layer-login").fadeIn(500),$.ajax({method:"GET",url:basehref+"check-login.php?email="+email}).done((function(result){result?($("#login-email").prop("disabled",!0),$(".btn-continue").hide(),$(".btn-login, .login-password").show(),$(".login-container .password-box, .forgot-password, .change-user").show(300),$(".forgot-password").show(300),hideErrorForm($(".email-box"))):($("#btn-continue").prop("disabled",!1),$("#btn-continue").val("Continue"),showErrorForm($(".email-box"),"Usuário não cadastrado!"),$("#login-email").val("")),$(".layer-login").fadeOut(500)})).fail((function(error){$("#btn-continue").prop("disabled",!1),$("#btn-continue").val("Continue"),$(".layer-login").fadeOut(500)})))}function mudaEmailAtLogin(){reset_form(),$(".btn-continue").show(300),$("#btn-continue").val("Continue"),$(".btn-login, .password-box, .forgot-password, .change-user").hide(),$("#login-email, #btn-continue").prop("disabled",!1)}function backToTheParent(){1==$(".register-container, .forgot-password-container").is(":visible")&&$(".register-container, .forgot-password-container").fadeOut((function(){openLoginModal()})),reset_form()}function showPassword(){var inputPasswords;"password"===$(this).parent().find("input")[0].type?$(this).parent().find('input[type="password"]').attr("type","text"):$(this).parent().find('input[type="text"]').attr("type","password"),$(this).toggleClass("view")}function modalPlano(){loadPlans(),$("#register-btn").val("Cadastrar"),$("#step-endereco, #step-pagamento, .login-container, .register-container, .forgot-password-container").hide(),$(".step-plano, .plans-container, .plano-container").show(),$("#login-modal").css("display","block"),$("#verify-btn").text("Verificar"),$("#register-btn, #verify-btn").prop("disabled",!1)}function loadPlans(){$(".layer-login").fadeIn(500),$.getJSON(apiUrl+"produtos",(function(produtos){var html='<span class="title">Que tal assinar O Dia?</span>';for(var x in produtos){var produto=produtos[x],isDegustacao=Boolean(produto.dias_degustacao>0);if(html+=`<div class="plano box-plano">\n                        <div class="dados-plano">\n                            <span class="nome-plano">${produto.nome}</span>\n                            <span class="desc-plano">${produto.descricao}</span>\n                            <figure><img src="${produto.imagem}" alt="${produto.nome}"></figure>`,isDegustacao)html+=`<div class="valor-anterior">\n                                    <small>De <i>R$ ${produto.valor.toLocaleString("pt-BR",{minimumFractionDigits:2})}</i></small>\n                                </div>\n                                <div class="price">\n                                    <span class="real">GRÁTIS*</span>\n                                    <p>*Por ${String(produto.dias_degustacao)} dias.</p>\n                                </div>`;else{var preco=String(produto.valor).split("."),real,centavo;html+=`\n                                    <div class="valor-cheio">\n                                        <span>R$ ${preco[0]},${preco.length>1?preco[1].padEnd(2,"0"):"00"}/mês<span>\n                                    </div>\n                                `}html+='<a class="btn--azul btnodia-assine" onclick="escolherPlano(\''+produto.cod_plano_dissim+"');\">Assine agora</a>",html+="</div>\n                    </div>"}html+='<div class="content-divisor"><strong class="divisor">Não desejo assinar</strong></div>',html+='<a class="btn--verde btn-form" onclick="goliveAssinatura();">Finalizar cadastro</a>',$(".step-plano").html(html),$(".layer-login").fadeOut(500)})).fail((function(e){$(".layer-login").fadeOut(500);var html='<h3 style="">Não foi possível carregar os planos, tente novamente mais tarde!</h3>';$(".step-plano").html(html)}))}function escolherPlano(plano){if($("#step-endereco").show(),$("#payment-plano").val(plano),User.user.celular){var tel=User.user.celular.replace(/\D/g,"");$("#payment-telefone").val(tel),$("#payment-telefone").trigger("input")}"ODIAIMP1"===plano?($(".step-plano, #modificar-verify-btn, #endereco-assinatura-success, #endereco-assinatura-fail, #payment-div-cep").hide(),$("#verify-btn, .verify-box").show(),$("#address-cep, #address-numero, #verify-btn").prop("disabled",!1),$.getJSON(apiUrl+"dissim/locais-entrega",(function(locais){var html='<option value="" disabled selected></option>';for(x in locais){var local=locais[x];html+='<option value="'+local+'">'+local+"</option>"}$("#address-local").html(html)}))):($(".step-plano, .verify-box").hide(),$("#step-pagamento").show(),$("#payment-cartao").focus())}function login(){$(".layer-login").fadeIn(500),$("#login-msg").hide(),$("#login-email").removeClass("input-error");var email=$("#login-email").val(),password=$("#login-password").val();$(".btn-login").prop("disabled",!0),$(".btn-login").val("Carregando"),$.ajax({method:"POST",url:apiUrl+"login",crossOrigin:!0,dataType:"json",data:{email:email,password:password}}).done((function(result){if(result.status&&200===result.status){$("#payment-senha").val(password);var token=result;$.ajax({method:"GET",url:apiUrl+"usuarios/me",crossOrigin:!0,headers:{Authorization:token.token_type+" "+token.access_token},dataType:"json"}).done((function(result){$(".btn-login").prop("disabled",!1),$(".btn-login").val("Entrar");var user=result;user.auth=token,User.setUser(user),defineTimeOrHoroscopo(),hideErrorForm($(".password-box"));var getUser=User.getUser();updateHeader(getUser),showHoroscope(getUser.horoscopo),showTeamNews(getUser.time),closeLoginModal()}))}})).fail((function(e){var error=e.responseJSON;if(error)var msg=error.message?error.message:"Erro ao fazer login!";else var msg="Erro ao fazer login!";$(".layer-login").fadeOut(500),$(".btn-login").prop("disabled",!1),$(".btn-login").val("Entrar"),showErrorForm($(".password-box"),msg)}))}function register(){var behavior=function(val){return 11===val.replace(/\D/g,"").length?"(00) 00000-0000":"(00) 0000-00009"},options={onKeyPress:function(val,e,field,options){field.mask(behavior.apply({},arguments),options)}};$("#register-phone").mask(behavior,options),$("#register-msg").css("display","none");var name=$("#register-name").val(),email=$("#register-email").val(),password=$("#register-password").val(),confirmPassword=$("#register-confirmPassword").val(),phone=$("#register-phone").val().replace(/[^\d\s]/g,""),terms=$("#register-terms").is(":checked"),horoscopo=$("#register-horoscopo").val(),time=$("#register-team").val();if(name)if(hideErrorForm($(".nome-box")),email)if(hideErrorForm($(".email-box")),password)if(hideErrorForm($(".password-box")),confirmPassword)if(hideErrorForm($(".confirm-password-box")),password==confirmPassword)if(hideErrorForm($(".password-box, .confirm-password-box")),terms){hideErrorForm($(".termos-box")),$("#register-btn").prop("disabled",!0),$("#register-btn").val("Carregando...");var data={name:name,email:email,password:password,phone:phone};horoscopo&&(data.horoscopo=horoscopo),time&&(data.time=time),$(".layer-login").fadeIn(500),$.ajax({method:"POST",url:basehref+"register.php",data:data,dataType:"json"}).done((function(result){let dadosUser;password&&$("#payment-senha").val(password),User.setUser(result),updateHeader(User.getUser()),modalPlano()})).fail((function(error){$(".layer-login").fadeOut(500),$("#register-btn").prop("disabled",!1),$("#register-btn").val("Cadastrar");const msg=error.responseText;$("#register-msg").html(msg.replace(/\n/g,"<br>")),$("#register-msg").show()}))}else showErrorForm($(".termos-box"),"Você precisa aceitar os termos de uso");else showErrorForm($(".password-box, .confirm-password-box"),"As senhas não conferem");else showErrorForm($(".confirm-password-box"),"Repita a mesma senha");else showErrorForm($(".password-box"),"Insira uma senha. Min. 6 dígitos");else showErrorForm($(".email-box"),"Insira seu e-mail");else showErrorForm($(".nome-box"),"Insira seu nome e sobrenome")}function updateHeader(dadosUsuario){$("body").addClass("logged"),$(".interactive-user .btn-signin-on span.username").html(dadosUsuario.name.substring(0,10)+"..."),null!=dadosUsuario.avatar&&$(".interactive-user .btn-signin-on .avatar-user").html(`<img alt=${dadosUsuario.name} src=${dadosUsuario.avatar} />`),$(".user-logged .layer-login").remove(),$(".options-user li").removeClass("active"),$(".box-content-function").addClass("hidden").removeClass("show"),updateMenuUser(dadosUsuario),localStorage.getItem("hasNewBookmarks")&&$(".bullet-new").addClass("active")}function updateMenuUser(dadosUsuario){$(".user-logged .user-area").find(".username p").html(dadosUsuario.name),$(".user-logged .user-area").find(".username span").html(dadosUsuario.email),$(".actions-user a:nth-child(2)").text("Olá, "+dadosUsuario.name.split(" ")[0]),$(".actions-user a:nth-child(2)").removeClass("off").addClass("on"),null!=dadosUsuario.avatar&&$(".user-logged .user-area").find(".avatar").html(`<img alt=${dadosUsuario.name} src=${dadosUsuario.avatar} />`),getFunctionsData(),goSAC()}function getFunctionsData(){var bookmarks;0==User.getBookmarks().length?($('div[data-content="bookmarks-user-menu"] .list').removeClass("show").addClass("hidden"),$('div[data-content="bookmarks-user-menu"] .placeholder, div[data-content="bookmarks-user-menu"]').removeClass("hidden").addClass("show")):isMobile||getUserBookmarks(!0),isMobile||$(".options-user li:nth-child(2)").addClass("active"),null==User.getHoroscopo()&&$('div[data-content="horoscopo-user-menu"] .placeholder').removeClass("hidden"),null==User.getTime()&&$('div[data-content="time-user-menu"] .placeholder').removeClass("hidden")}function getJSONtime(timeUser){$.getJSON(`${basehref}_midias/json/2020/ultimas-${timeUser}.json`,(function(result){montarNewsTime(result,timeUser)}))}function getJSONhoroscopo(horoscopoUser){$.getJSON(`${basehref}_midias/json/2020/signos.json`,(function(result){montarHoroscopoMenu(result,horoscopoUser)}))}function getUserBookmarks(isAddNew){var bookmarks=User.getBookmarks();if(isAddNew||($(".bullet-new").removeClass("active"),localStorage.removeItem("hasNewBookmarks")),isMobile&&($(".widget-functions .functions, .widget-functions .user-area").addClass("opened"),$('div[data-content="bookmarks-user-menu"]').removeClass("hidden").addClass("show")),isMobile||($('div[data-content="bookmarks-user-menu"]').removeClass("hidden").addClass("show"),$('div[data-content="bookmarks-user-menu"] .list').removeClass("hidden").addClass("show")),bookmarks.length>0){for(var articlehtml="",i=0;i<bookmarks.length;i++){var dataPubli=new Date(bookmarks[i].updated_at).toLocaleString("pt-BR"),tituloCortado;tituloCortado=isMobile?bookmarks[i].title.split(" ").splice(0,4).join(" ")+"...":bookmarks[i].title.split(" ").splice(0,8).join(" ")+"...",articlehtml+=`\n                <div class="linha" id="book-${bookmarks[i].id}">\n                    <article class="teaser ">\n                        <a class="flex align-center" href="${bookmarks[i].url}" title="${bookmarks[i].title}">\n                            <div class="wrap-data">\n                                <div class="chapeu">${dataPubli}</div>\n                                <p class="title">${tituloCortado}</p>\n                            </div>`,bookmarks[i].thumb&&(articlehtml+=`\n                            <figure>\n                                <img alt="${bookmarks[i].title}" src="/2020/common/static/CACHE/img/placehold.jpg" class="lazyload" data-src="${bookmarks[i].thumb}">        \n                            </figure>\n                    `),articlehtml+='</a><div class="actions"><a class="remove-article-bookmark flex align-center" onclick="removerArticleBookmark('+bookmarks[i].id+');"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28"><path d="M16.8 14L28 25.2 25.2 28 14 16.8 2.9 28 0 25.2 11.2 14 0 2.8 2.9 0 14 11.2 25.2 0 28 2.8 16.8 14z"></path></svg>Remover</a></div></article></div>'}$('div[data-content="bookmarks-user-menu"] .list').removeClass("hidden").addClass("show"),$('div[data-content="bookmarks-user-menu"] .placeholder').addClass("hidden"),$('div[data-content="bookmarks-user-menu"] .list').html(articlehtml),NOVODIA.UTEIS.lazyLoadImages()}}function goSAC(){if(User.isAuthenticated()){var token=User.getUser().auth.access_token;$(".options-user li:nth-child(1) a").prop("href","https://centraldoassinante.odia.com.br/authorize?access_token="+token)}}function definirHoroscopo(){var horoscopo=User.getHoroscopo();if(null!=horoscopo){var novoSigno;if($('div[data-content="horoscopo-user-menu"]').find("a.active").removeClass("active"),$('div[data-content="horoscopo-user-menu"]').find("a.signo--"+horoscopo).addClass("active"),$(".lista-signos-menu").has(event.target).length>0)horoscopo=novoSigno=$(event.target).data("signo"),User.setHoroscopo(horoscopo),$(".lista-signos-menu").find("a.active").removeClass("active"),$(this).find("a").addClass("active");getJSONhoroscopo(horoscopo)}else{var novoSigno;if($(".lista-signos-menu").has(event.target).length>0)horoscopo=novoSigno=$(event.target).data("signo"),User.setHoroscopo(horoscopo),getJSONhoroscopo(horoscopo)}showHoroscope(horoscopo),isMobile&&$(".widget-functions .functions, .widget-functions .user-area").addClass("opened")}function definirTime(){var time=User.getTime();if(null!=time){var novoTime;if($('div[data-content="time-user-menu"]').find("a.active").removeClass("active"),$('div[data-content="time-user-menu"]').find("a.escudo--"+time).addClass("active"),$(".lista-times-menu").has(event.target).length>0)time=novoTime=$(event.target).data("time"),User.setTime(time),$(".lista-times-menu").find("a.active").removeClass("active"),$(this).find("a").addClass("active");getJSONtime(time)}else{var novoTime;if($(".lista-times-menu").has(event.target).length>0)time=novoTime=$(event.target).data("time"),User.setTime(time),getJSONtime(User.getHoroscopo())}showTeamNews(time),isMobile&&$(".widget-functions .functions, .widget-functions .user-area").addClass("opened")}function montarNewsTime(result,timeUser){for(var articlehtml="",matias=result.matia,i=0;i<matias.length;i++){let imageTeaser=null;null!=matias[i].cd_midia&&(imageTeaser=matias[i].images["398x267"]);var dataPubli=new Date(matias[i].dt_matia_publi).toLocaleString("pt-BR");articlehtml+=`\n            <div class="linha">\n                <article class="teaser ">\n                    <a class="flex align-center" href="${matias[i].ds_matia_link}" title="${matias[i].ds_matia_titlo}">\n                        <div class="wrap-data">\n                            <div class="chapeu">${dataPubli}</div>\n                            <p class="title">${matias[i].ds_matia_titlo}</p>\n                        </div>`,imageTeaser&&(articlehtml+=`\n                        <figure>\n                            <img alt="${matias[i].title}" src="/2020/common/static/CACHE/img/placehold.jpg" class="lazyload" data-src="${imageTeaser}">        \n                        </figure>\n                `),articlehtml+="</a></article></div>"}isMobile&&($(".widget-functions .functions, .widget-functions .user-area").addClass("opened"),$('div[data-content="time-user-menu"]').removeClass("hidden").addClass("show")),$('div[data-content="time-user-menu"] .placeholder').is(":visible")&&$('div[data-content="time-user-menu"] .placeholder').addClass("hidden"),$('div[data-content="time-user-menu"] .list').html("").append(articlehtml),NOVODIA.UTEIS.lazyLoadImages()}function montarHoroscopoMenu(result,horoscopoUser){var htmlHoroscopo=`\n        <div class="my-horoscope flex algin-start">\n            <span class="signo--${horoscopoUser} lazyloaded"></span>\n            <div class="horoscopo">\n                <p>${result[horoscopoUser].nome}</p>\n                <p>${result[horoscopoUser].texto}</p>\n            </div>\n        </div>\n    `;$('div[data-content="horoscopo-user-menu"] .placeholder').is(":visible")&&$('div[data-content="horoscopo-user-menu"] .placeholder').addClass("hidden"),isMobile&&($(".widget-functions .functions, .widget-functions .user-area").addClass("opened"),$('div[data-content="horoscopo-user-menu"]').removeClass("hidden").addClass("show")),$('div[data-content="horoscopo-user-menu"] .my-horoscope').replaceWith(htmlHoroscopo)}function removerArticleBookmark(id){$.when($("#book-"+id).fadeOut(500)).then((function(){var qtdArticles;User.removeBookmark(id),$(this).remove(),0==$('div[data-content="bookmarks-user-menu"] .linha').length&&$('div[data-content="bookmarks-user-menu"] .placeholder').removeClass("hidden")}))}function backMenuUserMobile(){$(".options-user li").removeClass("active"),$(".widget-functions .functions, .widget-functions .user-area").removeClass("opened"),isMobile&&$(".box-content-function").addClass("hidden").removeClass("show")}function showMenuFloat(){isMobile?backMenuUserMobile():getUserBookmarks(!1),$(".user-logged").toggleClass("opened")}function openLoginModal(){$("#btn-continue, #login-email").prop("disabled",!1),$("#btn-continue").val("Continue"),$("#step-pagamento, #step-endereco, .step-plano, .plans-container, .forgot-password-container, .register-container, .login-container .password-box, .forgot-password, .btn-login").hide(),$(".btn-continue").show(),$(".login-container").fadeIn(500),$("#login-modal").css("display","block"),$("body").css({height:"auto","overflow-y":"hidden"}),$(".layer-login").fadeOut(500),"object"!=typeof firebase&&(loadScriptAsync("https://odia.ig.com.br/2020/common/cdn/mask/mask.min.js",(function(){$(".phoneMask").mask(SPMaskBehavior,spOptions),$(".cepMask").mask("00000-000"),$(".cpfMask").mask("000.000.000-00"),$(".validadeMask").mask("00/00"),$(".cvvMask").mask("0009"),$(".cartaoMask").mask(cartaoBehavior,cartaoOptions)})),loadScriptAsync("https://www.gstatic.com/firebasejs/5.8.4/firebase-app.js",(function(){loadScriptAsync("https://www.gstatic.com/firebasejs/5.8.4/firebase-auth.js",(function(){loadScriptAsync("https://odia.ig.com.br/2020/common/cdn/login-social.min.js")}))})))}function loadScriptAsync(url,callback){var elem=document.createElement("script");elem.src=url,document.body.appendChild(elem),elem.addEventListener("load",callback)}function logOutUser(){var htmlLayerLoad;$('<div class="layer-login" style="display: none;"><div class="loader"></div></div>').insertBefore(".user-logged .widget-functions"),$(".user-logged .layer-login").fadeIn(500),setTimeout((function(){User.logout(),$(".user-logged").removeClass("opened"),$("body").removeClass("logged"),$(".interactive-user .btn-signin-on span").html(""),$(".interactive-user .btn-signin-on .avatar-user").html('<svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" class="icon icon--user" aria-hidden="true"><path d="m 12,12 c 2.210001,0 4,-1.789999 4,-4 C 16,5.79 14.210001,4 12,4 9.790001,4 8,5.79 8,8 c 0,2.210001 1.790001,4 4,4 l 0,0 z m 0,2 c -2.67,0 -8,1.34 -8,4 l 0,2 16,0 0,-2 c 0,-2.66 -5.329999,-4 -8,-4 l 0,0 z"></path></svg>'),$(".actions-user a:nth-child(2)").text("Entrar"),$(".actions-user a:nth-child(2)").removeClass("on").addClass("off"),$('div[data-content="horoscopo-user-menu"] .my-horoscope').html(""),$('div[data-content="time-user-menu"] .list, div[data-content="bookmarks-user-menu"] .list').html(""),$(".lista-signos-menu li a, .lista-times-menu li a").removeClass("active")}),2e3)}function defineTimeOrHoroscopo(){var horoscopo=$("#register-horoscopo").val();horoscopo&&(User.setHoroscopo(horoscopo),showHoroscope(horoscopo));var time=$("#register-team").val();time&&(User.setTime(time),showTeamNews(time))}function goliveAssinatura(){$(".plano-container, .layer-login").fadeOut(500),$(".modal-content .sucesso-container").fadeIn(500)}$(".user-logged .section-name .back").click(backMenuUserMobile),$(".lista-times-menu li").click(definirTime),$(".lista-signos-menu li").click(definirHoroscopo),$(".show-password").click(showPassword),$(".btn-signin-off").click(openLoginModal),$(".btn-signin-on").click(showMenuFloat),$(".close-login").click(closeLoginModal),$(".btn-continue").click(checkEmail),$("#login-email").keyup((function(event){13===event.keyCode&&checkEmail()})),$(".change-user").click(mudaEmailAtLogin),$(".back-login").click(backToTheParent),$(".btn-login").click(login),$("#login-password").keyup((function(event){13===event.keyCode&&login()})),$("#register-btn").click(register),$(".open-modal-register").click((function(){reset_form();var loginEmail=$("#login-email").val();$("#register-email").val(loginEmail),$(".forgot-password-container, .plans-container, .login-container").hide(),$(".register-container").fadeIn(500)})),$(".forgot-password").click((function(){var email=$("#login-email").val();$("#forgot-password-email").val(email),$(".plans-container, .login-container").hide(),$(".forgot-password-container").fadeIn(500)})),$("#forgot-password-btn").click((function(){var email=$("#forgot-password-email").val();email?(hideErrorForm($(".box-esqueci-senha")),$(".layer-login").fadeIn(500),$("#forgot-password-btn").prop("disabled",!0),$("#forgot-password-btn").val("Carregando..."),$.ajax({method:"POST",url:apiUrl+"esqueci-senha",data:{email:email}}).done((function(result){var color="red",disabled=!1;"Enviamos seu link de redefinição de senha por e-mail!"===result&&(color="green",disabled=!0);var msg=$("#forgot-password-msg");msg.html(result),msg.css("color",color),msg.show(),$(".layer-login").fadeOut(500),$("#forgot-password-btn").prop("disabled",!1),$("#forgot-password-btn").val("Recuperar a senha")})).fail((function(e){$(".layer-login").fadeOut(500),$("#forgot-password-btn").prop("disabled",!1),$("#forgot-password-btn").val("Recuperar a senha");var error=e.responseJSON,msg=error.message?error.message:"Erro ao redefinir senha!",elm=$("#forgot-password-msg");elm.html(msg),elm.show(),$(".layer-login").fadeOut(500)}))):showErrorForm($(".box-esqueci-senha"),"Insira o e-mail de cadastro")})),$("#verify-btn").click((function(){var cep=$("#address-cep").val().replace("-",""),numero=$("#address-numero").val();cep?(hideErrorForm($(".cep-box")),numero?(hideErrorForm($(".numero-box")),$("#address-cep, #address-numero, #verify-btn").prop("disabled",!0),$("#verify-btn").text("Verificando..."),$(".layer-login").fadeIn(500),$.ajax({method:"GET",url:apiUrl+"dissim/verificar-entrega",data:{cep:cep,numero:numero}}).done((function(result){result?($.getJSON("https://viacep.com.br/ws/"+cep+"/json",(function(data){data.erro||($("#address-logradouro").val(data.logradouro),$("#address-bairro").val(data.bairro),$("#address-cidade").val(data.localidade))})),$("#endereco-assinatura-success, #step-pagamento, #modificar-verify-btn").show(),$("#endereco-assinatura-fail, #verify-btn").hide(),$(".layer-login").fadeOut(500)):($("#address-cep, #address-numero, #verify-btn").prop("disabled",!1),$("#verify-btn").text("Verificar"),$("#endereco-assinatura-success, #step-pagamento").hide(),$("#endereco-assinatura-fail").show(),$(".layer-login").fadeOut(500))})).fail((function(e){console.log("erro",e),$("#endereco-assinatura-success, #step-pagamento").hide(),$("#endereco-assinatura-fail").show(),$(".layer-login").fadeOut(500)}))):showErrorForm($(".numero-box"),"Digite o número do endereço")):showErrorForm($(".cep-box"),"Entre com um CEP válido")})),$("#modificar-verify-btn").click((function(){$("#modificar-verify-btn, #step-pagamento, #endereco-assinatura-success").hide(),$("#verify-btn").show(),$("#address-cep, #address-numero, #verify-btn").prop("disabled",!1),$("#verify-btn").text("Verificar")})),$("#finish-payment-btn").click((function(){$("#payment-fail").hide();var plano=$("#payment-plano").val(),cartao=$("#payment-cartao").cleanVal(),validade=$("#payment-validade").cleanVal(),cvv=$("#payment-cvv").cleanVal(),cpf=$("#payment-cpf").cleanVal(),cep=$("#payment-cep").cleanVal(),senha=$("#payment-senha").val(),telefone=$("#payment-telefone").val().replace(/[^\d\s]/g,"");if(data={cartao_numero:cartao,cartao_validade:validade,cartao_cvv:cvv,cpf:cpf,plano:plano,cep:cep,telefone:telefone},senha&&(data.senha=senha),"ODIAIMP1"===plano){if(data.cep=$("#address-cep").val().replace("-",""),data.numero=$("#address-numero").val(),data.complemento=$("#address-complemento").val(),data.local_entrega=$("#address-local").val(),!data.local_entrega)return void showErrorForm($(".box-local-jornal"),"Selecione o local para deixar o seu jornal O Dia");hideErrorForm($(".box-local-jornal"))}data.cartao_numero?(hideErrorForm($(".dados-cartao")),data.cartao_validade?(hideErrorForm($(".box-validade")),data.cartao_cvv?(hideErrorForm($(".box-cvv")),data.cpf?(hideErrorForm($(".box-cpf")),data.cep||"ODIAIMP1"!==plano?(hideErrorForm($(".box-cep")),$("#finish-payment-btn").val("Carregando..."),$("#finish-payment-btn, #payment-plano, #payment-cartao, #payment-validade, #payment-cvv, #payment-cpf, #payment-cep, #payment-senha, #payment-telefone").prop("disabled",!0),$(".layer-login").fadeIn(500),User.assinar(data,(function(success){User.changeStatus("A"),$(".plano-container, .layer-login").fadeOut(500),$(".modal-content .sucesso-container").fadeIn(500)}),(function(error){var msg=error.responseJSON;if(msg&&msg.details){var html="";for(var x in msg.details){var detail=msg.details[x];detail[0]&&(html+="<p>"+detail[0]+"</p>")}msg=html,$("#finish-payment-btn").val("Finalizar"),$(".layer-login").fadeOut(500),$("#finish-payment-btn, #payment-plano, #payment-cartao, #payment-validade, #payment-cvv, #payment-cpf, #payment-cep, #payment-senha, #payment-telefone").prop("disabled",!1)}else{msg=error.responseText?error.responseText:"Erro ao realizar assinatura";try{msg=JSON.parse(msg)}catch(e){}msg.message&&(msg=msg.message),msg="<p>"+msg+"</p>",$("#finish-payment-btn, #payment-plano, #payment-cartao, #payment-validade, #payment-cvv, #payment-cpf, #payment-cep, #payment-senha, #payment-telefone").prop("disabled",!1),$("#finish-payment-btn").val("Finalizar")}$("#finish-payment-btn, #payment-plano, #payment-cartao, #payment-validade, #payment-cvv, #payment-cpf, #payment-cep, #payment-senha, #payment-telefone").prop("disabled",!1),$("#finish-payment-btn").val("Finalizar"),$("#payment-fail").html(msg),$("#payment-fail").show(),$(".layer-login").fadeOut(500)}))):showErrorForm($(".box-cep"),"Entre com um CEP válido")):showErrorForm($(".box-cpf"),"Digite um CPF válido")):showErrorForm($(".box-cvv"),"Digite o código de segurança")):showErrorForm($(".box-validade"),"Digite a data de vencimento")):showErrorForm($(".dados-cartao"),"Digite os números do seu cartão de crédito")})),$("#login_facebook, #login_google").on("click",(function(){var provider=jQuery(this).data("login");loginSocial(provider,(function(result){if(result.name){User.setUser(result),defineTimeOrHoroscopo(),"A"!==result.status?modalPlano():closeLoginModal();var getUser=User.getUser();updateHeader(getUser),showHoroscope(getUser.horoscopo),showTeamNews(getUser.time)}else $(".layer-login").fadeOut(500)}))})),$(document).ready((function(){SPMaskBehavior=function(val){return 11===val.replace(/\D/g,"").length?"(00) 00000-0000":"(00) 0000-00009"};var spOptions_onKeyPress=function(val,e,field,options){field.mask(SPMaskBehavior.apply({},arguments),options)};cartaoBehavior=function(val){if(Boolean(val)&&val.length>=2){var twoNumbers=val.substring(0,2);return"34"==twoNumbers||"37"==twoNumbers?"000 000000 00000":"0000 0000 0000 0000"}return"0000 0000 0000 0000"},cartaoOptions={onKeyPress:function(val,e,field,options){field.mask(cartaoBehavior.apply({},arguments),options)}};var isUserActive=User.getUser();null!=isUserActive&&updateHeader(isUserActive)}));